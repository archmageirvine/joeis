package irvine.oeis;

import java.util.function.Predicate;

import irvine.math.z.Z;

/**
 * A sequence generated by conditionally selecting particular terms depending on the current index.
 * @author Georg Fischer
 */
public class FilterNumberSequence extends AbstractSequence {

  private final Predicate<Integer> mPredicate;
  private int mN; // current index to be tested

  /**
   * Filter with just the sequence value.
   * @param offset offset of filtered sequence
   * @param start first index to be tested
   * @param predicate predicate used for filtering
   */
  public FilterNumberSequence(final int offset, final int start, final Predicate<Integer> predicate) {
    super(offset);
    mN = start - 1;
    mPredicate = predicate;
  }

  /**
   * Filter with just the sequence value.
   * @param offset offset of filtered sequence
   * @param predicate predicate used for filtering
   */
  public FilterNumberSequence(final int offset, final Predicate<Integer> predicate) {
    this(offset, offset, predicate);
  }

  @Override
  public Z next() {
    while (true) {
      ++mN;
      if (mPredicate.test(mN)) {
        return Z.valueOf(mN);
      }
    }
  }
}
