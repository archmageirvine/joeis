package irvine.oeis.a072;

import java.util.Arrays;

import irvine.math.z.Z;
import irvine.oeis.Sequence1;

/**
 * A072844 Number of words of length 2n-1 generated by the two letters s and t that reduce to the identity 1 by using the relations sssssss=1, tt=1 and stst=1. The generators s and t along with the three relations generate the 14-element dihedral group D7.
 * @author Sean A. Irvine
 */
public class A072844 extends Sequence1 {

  // After method described by Allan Wechsler

  private static final int[][] TRANSITIONS = {
    {1, 7},
    {2, 8},
    {3, 9},
    {4, 10},
    {5, 11},
    {6, 12},
    {0, 13},
    {0, 13},
    {1, 7},
    {2, 8},
    {3, 9},
    {4, 10},
    {5, 11},
    {6, 12}
  };

  private Z[] mCounts = null;

  @Override
  public Z next() {
    for (int j = 0; j < 2; ++j) {
      if (mCounts == null) {
        mCounts = new Z[14];
        Arrays.fill(mCounts, Z.ZERO);
        mCounts[0] = Z.ONE;
      } else {
        final Z[] c = new Z[mCounts.length];
        for (int k = 0; k < c.length; ++k) {
          Z s = Z.ZERO;
          for (final int t : TRANSITIONS[k]) {
            s = s.add(mCounts[t]);
          }
          c[k] = s;
        }
        mCounts = c;
      }
    }
    return mCounts[0];
  }
}

