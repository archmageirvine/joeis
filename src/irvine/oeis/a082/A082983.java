package irvine.oeis.a082;

import java.util.PriorityQueue;

import irvine.math.z.Z;
import irvine.oeis.Sequence0;

/**
 * A082983 Odd numbers which lead to 1 in the 3x+1 problem, generated by a particular "least-first" greedy algorithm (see program code).
 * @author Sean A. Irvine
 */
public class A082983 extends Sequence0 {

  private final PriorityQueue<Z> mQueue = new PriorityQueue<>();
  {
    mQueue.add(Z.ONE);
  }

  @Override
  public Z next() {
    final Z n = mQueue.poll();
    mQueue.add(n.multiply(4).add(1));
    final long r = n.mod(3);
    if (r == 1) {
      Z m = n.multiply(4).subtract(1).divide(3).makeOdd();
      if (m.compareTo(Z.ONE) > 0) {
        mQueue.add(m);
      }
    } else if (r == 2) {
      Z m = n.multiply(2).subtract(1).divide(3).makeOdd();
      if (m.compareTo(Z.ONE) > 0) {
        mQueue.add(m);
      }
    }
    return n;
  }
}
