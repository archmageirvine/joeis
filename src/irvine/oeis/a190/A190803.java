package irvine.oeis.a190;
// manually 2021-09-02

import java.util.TreeSet;

import irvine.math.z.Z;
import irvine.oeis.Sequence1;

/**
 * A190803 Increasing sequence generated by these rules: a(1)=1, and if x is in a then 2x-1 and 3x-1 are in a.
 * @author Georg Fischer
 */
public class A190803 extends Sequence1 {

  protected long mN; // current index
  protected Z mX; // current element
  protected final TreeSet<Z> mA;

  /** Construct the sequence. */
  public A190803() {
    mA = new TreeSet<>();
    mN = 0;
    mX = Z.ZERO;
    insert(Z.ONE);
  }

  /**
   * Insert a single terms depending on the parameter
   * @param x new term
   */
  protected void insert(final Z x) {
    if (mX.compareTo(x) < 0) {
      mA.add(x);
    }
  }

  /**
   * Inserts two terms depending on the parameter
   * @param x existing term
   */
  protected void insertTerms(final Z x) {
    insert(x.multiply2().subtract(1));
    insert(x.multiply(3).subtract(1));
  }

  @Override
  public Z next() {
    ++mN;
    mX = mA.pollFirst();
    insertTerms(mX);
    return mX;
  }
}
