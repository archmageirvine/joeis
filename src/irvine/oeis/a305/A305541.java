package irvine.oeis.a305;
// Generated by gen_seq4.pl 2024-04-22/trilambn at 2024-04-22 22:28

import irvine.math.function.Functions;
import irvine.math.q.Q;
import irvine.math.z.Integers;
import irvine.math.z.Stirling;
import irvine.oeis.triangle.LambdaTriangle;

/**
 * A305541 Triangle read by rows: T(n,k) is the number of chiral pairs of color loops of length n with exactly k different colors.
 * @author Georg Fischer
 */
public class A305541 extends LambdaTriangle {

  /** Construct the sequence. */
  public A305541() {
    super(1, 1, 1, (n, k) -> new Q(Integers.SINGLETON.sumdiv(n, d -> Stirling.secondKind(n / d, k).multiply(Functions.PHI.z(d))), 2 * n).subtract(new Q(Stirling.secondKind((n + 1) / 2, k).add(Stirling.secondKind(n / 2 + 1, k)), 4)).multiply(Functions.FACTORIAL.z(k)).num());
  }
}
